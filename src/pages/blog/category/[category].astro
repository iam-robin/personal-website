---
import { getCollection } from "astro:content";
import BlogPage from "@components/blog/BlogPage.astro";

export async function getStaticPaths() {
    const blogPosts = await getCollection("blog");
    const categories = [...new Set(blogPosts.map((post) => post.data.category))];

    return categories.map((category) => ({
        params: { category },
        props: { category },
    }));
}

const { category } = Astro.params;
const allBlogPosts = await getCollection("blog");
const filteredPosts = allBlogPosts.filter(
    (post) => post.data.category === category
);
---

<BlogPage
    posts={filteredPosts}
    allPosts={allBlogPosts}
    selectedCategory={category}
/>
