---
import Grid from "./Grid.astro";
import GridItem from "./GridItem.astro";
import Link from "./Link.astro";
import { Icon } from "astro-icon/components";
---

<div data-hero class="min-h-dvh flex items-center opacity-0">
    <Grid>
        <!-- text-[max(1.7rem,6cqw)] -->
        <GridItem colSpan={12}>
            <h1 class="text-2xl lg:text-4xl leading-tight font-bold">
                Hey
                <Icon
                    data-hero-icon
                    class="inline-block align-[-0.25em] opacity-0 w-0 -mr-3 overflow-hidden"
                    name="sticker-smiley-50"
                    size="72px"
                />
                I am <Link href="/about">Robin Spielmann</Link>.
                <br class="hidden sm:block" />
                A Design Engineer who enjoys working at the intersection of
                <br class="hidden sm:block" />
                <Icon
                    data-hero-icon
                    class="inline-block align-[-0.25em] opacity-0 w-0 -mr-3 overflow-hidden"
                    name="sticker-code-50"
                    size="72px"
                />
                code,
                <Icon
                    data-hero-icon
                    class="inline-block align-[-0.25em] opacity-0 w-0 -mr-3 overflow-hidden"
                    name="sticker-design-50"
                    size="72px"
                />
                design and
                <Icon
                    data-hero-icon
                    class="inline-block align-[-0.25em] opacity-0 w-0 -mr-3 overflow-hidden"
                    name="sticker-art-50"
                    size="72px"
                />
                art.
            </h1>
        </GridItem>
        <GridItem
            colStart={{ small: 1, medium: 1, large: 5 }}
            colEnd={{ small: 13, medium: 13, large: 13 }}
        >
            <p data-hero-subtitle class="text-md font-mono opacity-0 mt-6">
                This personal website is my own little space on the internet
                where I want to share my work, interests and passions with
                others, without having to please the algorithms of social media
                platforms or follow any other rules. I hope you enjoy exploring
                my digital living room as much as I enjoyed creating it.
            </p>
        </GridItem>
    </Grid>
</div>

<script>
    import { animate, stagger } from "motion";

    function animateHero() {
        const hero = document.querySelector("[data-hero]");
        if (!hero) return;

        // Reset to initial state before animating
        (hero as HTMLElement).style.opacity = "0";
        const icons = hero.querySelectorAll("[data-hero-icon]");
        icons.forEach((icon) => {
            (icon as HTMLElement).style.opacity = "0";
            (icon as HTMLElement).style.width = "0px";
        });
        const subtitle = hero.querySelector("[data-hero-subtitle]");
        if (subtitle) {
            (subtitle as HTMLElement).style.opacity = "0";
        }

        // Fade in the hero section first
        animate(hero, { opacity: [0, 1] }, { duration: 1 });

        // Then pop in icons one after another
        if (icons.length > 0) {
            animate(
                icons,
                {
                    marginRight: [-12, -4],
                    opacity: [0, 1],
                    y: [25, 0],
                    width: ["0px", "72px"],
                },
                {
                    type: "spring",
                    stiffness: 100,
                    damping: 12,
                    mass: 1.5,
                    delay: stagger(0.25, { startDelay: 0.25 }),
                }
            );
        }

        // Animate subtitle after icons are done
        if (subtitle) {
            animate(
                subtitle,
                { opacity: [0, 1], y: [20, 0] },
                { duration: 0.6, delay: 1.5, ease: [0.39, 0.24, 0.3, 1] }
            );
        }
    }

    // Re-run when navigating back via View Transitions
    document.addEventListener("astro:page-load", animateHero);
</script>
