---
import type { Book } from "@api/github-books";
import BookSpine from "./BookSpine.astro";

interface Props {
    books: Book[];
}

const { books } = Astro.props;

// Sort by finished date ascending (oldest at bottom)
const sortedBooks = [...books].sort((a, b) => {
    const dateA = a.finished ? new Date(a.finished).getTime() : 0;
    const dateB = b.finished ? new Date(b.finished).getTime() : 0;
    return dateA - dateB;
});
---

<div class="spine-stack relative flex flex-col-reverse items-center w-full">
    {sortedBooks.map((book) => <BookSpine book={book} />)}
</div>

<style>
    .spine-stack::before {
        content: "";
        position: absolute;
        bottom: -4px;
        left: -5%;
        width: 110%;
        height: 10px;
        border-radius: 50%;
        pointer-events: none;
        background: radial-gradient(
            ellipse at center,
            rgba(0, 0, 0, 0.4) 0%,
            transparent 65%
        );
    }

    .spine-stack::after {
        content: "";
        position: absolute;
        bottom: -12px;
        left: -25%;
        width: 150%;
        height: 24px;
        border-radius: 50%;
        pointer-events: none;
        background: radial-gradient(
            ellipse at center,
            rgba(0, 0, 0, 0.28) 0%,
            transparent 60%
        );
    }
</style>
